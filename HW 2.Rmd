---
title: "HW 2"
author: "Nicholas Marey"
date: "September 12, 2017"
output: pdf_document
---


#1. Assume the Bayesian model with likelihood $Y | \theta ~ Binomial(n, \theta)$ and prior $\theta ~ Beta(a,b)$. Write a function that uses Monte Carlo sampling to estimate the posterior mean and standard deviation of $\theta$Â¸ given we observe $Y = y$. The function should take inputs $y, n, a, and b$. Given these inputs, the function should generate 1, 000, 000 samples of $(\theta, Y )$ (by first drawing $\theta$ from a beta distribution and then $Y | \theta$ from a binomial distribution), extract the samples with $Y = y$, and return the mean and standard deviation of $\theta$ for these samples. Include code for this function in your write-up.

```{r}
question <- function(y, n, a, b){
  theta<-rbeta(1e+06,a,b)
  like<-rbinom(1e+06,n,theta)
  post<-rbeta(1e+06, like+a, n-like+b) #posterior probability distribution
  post<-as.data.frame(cbind(post,like))
  avg<-as.data.frame(tapply(post$post,post$like,mean))
  sd<-as.data.frame(tapply(post$post,post$like,sd))
  values<-unique(post$like)
  values<-values[order(values)]
  dat<-cbind(values,avg,sd)
  colnames(dat)<-c("k","mean","sd")
  dat1<-dat[dat$k %in% y, ]
  colnames(dat1)<-c("y","Mean","Standard Deviation")
  return(dat1)
}

```

# 2. Use the code from (1) with $n = 10$ and $a = b = 1$ to compute the posterior mean and standard deviation for $\theta$, for all $y = 0, 1, . . . , n$ and plot the posterior mean and standard deviation as a function of $y$.


```{r }

library(ggplot2)
library(gridExtra)
set.seed(1)
p2<-question(0:10, 10, 1, 1)
plot1<-ggplot(p2, aes(y, Mean))+geom_point()
plot2<-ggplot(p2, aes(y, `Standard Deviation`))+geom_point()
grid.arrange(plot1, plot2, ncol=2)
```

#3. Use the code from (1) with $n = 10$ and $a = b = 10$ to compute the posterior mean and standarddeviation for $\theta$ for all $y = 0, 1, . . . , n$ and plot the posterior mean and standard deviation as a function of $y$.


```{r }
set.seed(1)
p3<-question(0:10, 10, 10, 10)
plot3<-ggplot(p3, aes(y, Mean))+geom_point()
plot4<-ggplot(p3, aes(y, `Standard Deviation`))+geom_point()
grid.arrange(plot3, plot4, ncol=2)
```

# 4. Comment on the differences between the plots with $a = b = 1$ versus $a = b = 10$.

